{% extends "base.html" %}

{% block title %}
	HHDC Contracts &gt; {{hhdc_contract.name}}
{% endblock %}

{% block nav %}
	<a href="{{context_path}}/hhdc_contracts">HHDC Contracts</a> &gt;
	<a href="{{context_path}}/hhdc_contracts/{{hhdc_contract.id}}">
		{{hhdc_contract.name}}
	</a> &gt; Edit
{% endblock %}

{% block content %}
	{% if request.method == 'GET' and request.values.view == 'confirm_delete' %}
		<form method="delete" action="">
			<fieldset>
				<legend>
					Are you sure you want to delete this contract?
				</legend>
				<input type="submit" name="delete" value="Delete">
			</fieldset>
		</form>
		<p>
			<a href="">Cancel</a>
		</p>
	{% else %}
		<form action="" method="post">
			<fieldset>
				<legend>Update Contract</legend>
				<input type="hidden" name="hhdc_contract_id"
					value="{{hhdc_contract.id}}"
				>
				<br>
				<label>Party</label>
				<select name="party_id">
					{% for party in parties %}
						{{ input_option('party_id', party.id, party.participant.code + ' : ' + party.name, hhdc_contract.party.id) }}
					{% endfor %}
				</select>
				<br>
				<label>
					Name
				</label>
				{{input_text('name', hhdc_contract.name)}}
				<br>
				<br>
				Charge script
				<br>
				{{input_textarea('charge_script', hhdc_contract.charge_script, 40, 80)}}
				<br />
				<br>
				Properties
				<br>
				{{input_textarea('properties', hhdc_contract.properties, 40, 80)}}
				<br />
				<br />
				<h4>Example</h4>
				<code><pre>
{
	'has_importer': True,
	'file_type': '.df2',
	'hostname': 'example.com',
	'username': 'username',
	'password': 'password',
	'directories': ['downloads1', 'downloads2']}
				</pre></code>
				<input type="submit" value="Update">
			</fieldset>
		</form>
		<br>
		<br>
		<form action="" method="post">
			<fieldset>
				<legend>Update State</legend>
				<input type="hidden" name="hhdc_contract_id"
								value="{{hhdc_contract.id}}">
				<label>State</label>
				<br>
				{{ input_textarea('state', hhdc_contract.state, 40, 80) }}
				<br>
				<input type="submit" name="update_state" value="Update">
			</fieldset>
		</form>
		<br>

		<form action="">
			<fieldset>
				<legend>Delete this contract</legend>
				<input
			 		type="hidden" name="hhdc_contract_id" value="{{hhdc_contract.id}}">
				<input type="hidden" name="view" value="confirm_delete">
				<input type="submit" value="Delete">
			</fieldset>
		</form>
		<br>
		<form method="post" action="">
			<fieldset>
				<legend>Ignore all snags before</legend>
				<input type="hidden" name="hhdc_contract_id" value="{{hhdc_contract.id}}">
				<br>
				{{ input_date('ignore', initial_date) }}
				<input type="submit" name="ignore_snags" value="Ignore">
			</fieldset>
		</form>
	{% endif %}
{% endblock %}
