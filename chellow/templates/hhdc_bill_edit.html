{% extends "base.html" %}

{% block title %}
	HHDC Contracts &gt; {{bill.batch.contract.name}} &gt; Batches &gt;
  {{bill.batch.reference}} &gt; Bills &gt; {{bill.id}}
{% endblock %}

{% block nav %}
	<a href="{{context_path}}/hhdc_contracts">HHDC Contracts</a> &gt;
	<a
			href="{{context_path}}/hhdc_contracts/{{bill.batch.contract.id}}"
			>{{bill.batch.contract.name}}</a> &gt;
	<a
			href="{{context_path}}/hhdc_batches?hhdc_contract_id={{bill.batch.contract.id}}"
			>Batches</a> &gt;
	<a
			href="{{context_path}}/hhdc_batches/{{bill.batch.id}}"
			>{{bill.batch.reference}}</a> &gt;
	<a href="{{context_path}}/hhdc_bills/{{bill.id}}">Bill {{bill.id}}</a> &gt;
	Edit
{% endblock %}

{% block content %}
    {% if 'confirm_delete' in request.values %}
      <form method="post" action="">
        <fieldset>
          <legend>Are you sure you want to delete this bill?</legend>
          <input type="submit" name="delete" value="Delete">
        </fieldset>
      </form>
      <p><a href="{{context_path}}/hhdc_bills/{{bill.id}}/edit">Cancel</a></p>
    {% else %}
      <form action="" method="post">
        <fieldset>
          <legend>Update This Bill</legend>
          <p>
            <a href="{{context_path}}/supplies/{{bill.supply.id}}">Supply</a>
          </p>
          <label>
            Reference {{input_text('reference', bill.reference)}}
          </label>
          <br>
          <label>
            Account {{input_text('account', bill.account)}}
          </label>
          <br><br>
          <fieldset>
            <legend>Issue Date</legend>
            {{input_date('issue', bill.issue_date)}}
          </fieldset>
          <br>
          <fieldset>
            <legend>Start Date</legend>
            {{input_date('start', bill.start_date)}}
          </fieldset>
          <br>
          <fieldset>
            <legend>Finish Date</legend>
            {{input_date('finish', bill.finish_date)}}
          </fieldset>
          <br>
          <label>
            kWh {{input_text('kwh', '' ~ bill.kwh)}}
          </label>
          <br>
          <label>
            Net {{input_text('net', '' ~ bill.net)}}
          </label>
          <br>
          <label>
            VAT {{input_text('vat', '' ~ bill.vat)}}
          </label>
          <br>
          <label>Gross {{input_text('gross', '' ~ bill.gross)}}</label>
          <br>
          <label>Type
            <select name="bill_type_id">
              {% for type in bill_types %}
                {{input_option('type_id', type.id, type.code + ' ' + type.description, initial=bill.bill_type.id)}}
              {% endfor %}
            </select>
          </label>
          <br><br>
          <label>
            Breakdown <br>
            {{input_textarea('breakdown', bill.breakdown, 10, 80)}}
          </label>
          <br>
          Example Breakdown

          <pre>
{'raw_lines': ['"net-gbp", "unrestricted-kwh", "unrestricted-rate", "unrestricted-gbp"',
 '"100", "1000", "0.1", "100"'],
 'unrestricted-kwh': 1000, 'unrestricted-rate': 0.1, 'unrestricted-gbp': 100}          </pre>
          <br>
          <input type="submit" name="update" value="Update">
        </fieldset>
      </form>
      <br>
      <form action="">
        <fieldset>
          <legend>Delete This Bill</legend>
          <input type="submit" name="confirm_delete" value="Delete">
        </fieldset>
      </form>
    {% endif %}
{% endblock %}
